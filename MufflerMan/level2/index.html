/*
Level2..
similar to copterIt.



*/

<!DOCTYPE html>
<head>
	<link rel="stylesheet" href="../style.css"></link>
  <link href="../assets/bootstrap.css" rel="stylesheet">
</head>
<body>


	<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=1488321171431950&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
  </script>




<canvas id="canvas" ></canvas>
<div id="over_msg">
<br><br><br>
Game Over 
<br><br><br><br><br>
<button type="button" class="btn btn-primary" onclick="window.location.href=''">Play Again</button>
<br><br><br><br><br>
<div id="score_details"></div>
<br><br><br>
<div class="fb-share-button" data-href="https://developers.facebook.com/docs/plugins/" data-layout="button"></div>

<a href="https://twitter.com/intent/tweet?button_hashtag=Play4AAP&text=Vote%20for%20Kejriwal" class="twitter-hashtag-button" data-related="stndlkr200,stndlkr200">Tweet #Play4AAP</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

</div>
<script type="text/javascript" src="../jquery.js"></script>
<script type="text/javascript">




var gravity=2,
    veloX=2,
    key=[],
    xp=50,
    yp=300,
    veloY=2,
    r=5,
    col=0,
    flag=0;


var canvas=document.getElementById('canvas'),
    ctx=canvas.getContext('2d'),
     w = 0.9*window.innerWidth,
     h = document.body.offsetHeight;

     canvas.width=w;
     canvas.height=h;

     ctx.clearRect(0,0,w,h);



document.addEventListener("keydown",function(e){
   key[e.keyCode]=true;
});

document.addEventListener("keyup",function(e){
   key[e.keyCode]=false;
});    

var setTimer3=setInterval(updateMufflerManPos,10);


function bar(x1,y1,x2,y2){
  this.x1=x1;
  this.y1=y1;
  this.x2=x2;
  this.y2=y2;
}

var bars=[];

var barss={
  b1: {
     x1:200,y1:100,x2:200,y2:250
    },
  b2: {
     x1:200,y1:300,x2:200,y2:500
    },
  b3: {
     x1:300,y1:100,x2:300,y2:190
    },
  b4: {
     x1:300,y1:250,x2:300,y2:500
    },
  b5: {
     x1:500,y1:100,x2:500,y2:230
    },
  b6: {
     x1:500,y1:270,x2:500,y2:500
    },
  b7: {
     x1:600,y1:100,x2:600,y2:190
    },
  b8: {
     x1:600,y1:240,x2:600,y2:500
    },
  b9: {
     x1:800,y1:100,x2:800,y2:280
    },
  b10: {
     x1:800,y1:320,x2:800,y2:500
    },
    
  b11: {
     x1:900,y1:240,x2:900,y2:500
    },

 b12: {
     x1:900,y1:100,x2:900,y:150
    }        

};

bars.push(new bar(barss.b1.x1,barss.b1.y1,barss.b1.x2,barss.b1.y2));
bars.push(new bar(barss.b2.x1,barss.b2.y1,barss.b2.x2,barss.b2.y2));
bars.push(new bar(barss.b3.x1,barss.b3.y1,barss.b3.x2,barss.b3.y2));
bars.push(new bar(barss.b4.x1,barss.b4.y1,barss.b4.x2,barss.b4.y2));
bars.push(new bar(barss.b5.x1,barss.b5.y1,barss.b5.x2,barss.b5.y2));
bars.push(new bar(barss.b6.x1,barss.b6.y1,barss.b6.x2,barss.b6.y2));
bars.push(new bar(barss.b7.x1,barss.b7.y1,barss.b7.x2,barss.b7.y2));
bars.push(new bar(barss.b8.x1,barss.b8.y1,barss.b8.x2,barss.b8.y2));
bars.push(new bar(barss.b9.x1,barss.b9.y1,barss.b9.x2,barss.b9.y2));
bars.push(new bar(barss.b10.x1,barss.b10.y1,barss.b10.x2,barss.b10.y2));
bars.push(new bar(barss.b11.x1,barss.b11.y1,barss.b11.x2,barss.b11.y2));
bars.push(new bar(barss.b12.x1,barss.b12.y1,barss.b12.x2,barss.b12.y2));



function updateMufflerManPos(){

  ctx.clearRect(0,0,w,h);
   
   //draw ball

   ctx.beginPath();
   ctx.arc(xp+=veloX,yp,r,0,2*Math.PI);
   ctx.fillStyle='white';
   ctx.fill();


  
  ctx.beginPath();
  ctx.lineWidth='5';
  ctx.lineWidth='5';
  ctx.strokeStyle="rgba(45,67,321,0.9)";    
      for(var z=0;z<11;z++){
         var p=bars[z];
        
        ctx.moveTo(p.x1,p.y1);
        ctx.lineTo(p.x2,p.y2);
        ctx.stroke();

     //collisions
      


  if(xp>=200 && xp<=205 && yp<=250 && yp>=100){
     veloX*=-1; col++;

  }
  
  if(xp>=200 && xp<=205 && yp<=500 && yp>=300){
      veloX*=-1; col++;
  }

    if(xp>=300 && xp<=305 && yp<=190 && yp>=100){
     veloX*=-1; col++;

  }
  
  if(xp>=300 && xp<=305 && yp<=500 && yp>=250){
       veloX*=-1; col++;

  }
  
  if(xp>=500 && xp<=505 && yp<=230 && yp>=100){
     veloX*=-1; col++;

  }
  
  if(xp>=500 && xp<=505 && yp<=500 && yp>=270){
       veloX*=-1; col++;

  }
 
   if(xp>=600 && xp<=605 && yp<=190 && yp>=100){
     veloX*=-1;  col++;

  }
  
  if(xp>=600 && xp<=605 && yp<=500 && yp>=240){
       veloX*=-1; col++;

  }

  if(xp>=800 && xp<=805 && yp<=280 && yp>=100){
     veloX*=-1;  col++;

  }
  
  if(xp>=800 && xp<=805 && yp<=500 && yp>=320){
       veloX*=-1; col++;

  }
 
  if(xp>=900 && xp<=905 && yp>=240 && yp<=500){
     veloX*=-1; col++;
  }
  
 


      }
     



       
     ctx.beginPath();
     ctx.moveTo(w-100,220);
     
     ctx.lineTo(w-20,220);
     ctx.strokeStyle="orange";
     ctx.stroke();
     
     ctx.beginPath();
     ctx.moveTo(w-20,220);
     ctx.lineTo(w-20,340);
     ctx.strokeStyle="white";
     ctx.stroke();
     
     ctx.beginPath();
     ctx.moveTo(w-20,340);
     ctx.lineTo(w-100,340);
     ctx.strokeStyle="lightgreen";
     
     ctx.stroke();

     ctx.fillStyle="white";
     ctx.font="bold 13px Georgia";
     ctx.fillText("Vidhan Sabha",w-100,380);

     ctx.beginPath();
     ctx.moveTo(100,220);
     
     ctx.lineTo(10,220);
     ctx.strokeStyle="orange";
     ctx.stroke();
     
     ctx.beginPath();
     ctx.moveTo(10,220);
     ctx.lineTo(10,340);
     ctx.strokeStyle="white";
     ctx.stroke();
     
     ctx.beginPath();
     ctx.moveTo(10,340);
     ctx.lineTo(100,340);
     ctx.strokeStyle="lightgreen";
     
     ctx.stroke();

     ctx.fillStyle="white";
     ctx.font="bold 13px Georgia";
     ctx.fillText("AAP Office",15,380);
   

 if(key[32]==true && yp>=110)
  yp-=1;
 else if(key[32]==false && yp<=490)
  yp+=gravity;
  else
    veloY*=-1;

   

  if(xp>=w-20){
    if(veloX<7)veloX++;
    flag=1;
    veloX*=-1;
    
  }

  if(xp<=10 ){
    if(veloX>0)veloX--;
    veloX*=-1;

    if(flag==1)
       flag=2;
    
  }

  // if(yp<=100 || yp>=500){
    //veloY*=-1;
   //}
  


ctx.clearRect(400,10,300,20);
ctx.fillStyle="white";
ctx.font="bold 14px Georgia";
ctx.fillText("Collisions: "+ col/11 +"  You cannot do more than 10 collisions & come back to AAP office!",450,15);
 if(col/11>10 || flag==2){
   clearInterval(setTimer3);
     score=10-col/11;
   document.getElementById('over_msg').style.display="block";
    if(flag==2)
   document.getElementById('score_details').innerHTML="Congrats !! Your Score "+ score;
    else
   document.getElementById('score_details').innerHTML="Sad :( Your Score "+ score;
  }

}



</script>
</body>
</html>